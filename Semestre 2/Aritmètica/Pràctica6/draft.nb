(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     17267,        432]
NotebookOptionsPosition[     15746,        374]
NotebookOutlinePosition[     16097,        389]
CellTagsIndexPosition[     16054,        386]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Xifrar", "[", 
   RowBox[{"text0_", ",", "PQ0_", ",", "e0_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"text", " ", "=", "text0"}], ",", 
      RowBox[{"PQ", "=", "PQ0"}], ",", 
      RowBox[{"e", "=", "e0"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mA", " ", "=", " ", 
      RowBox[{"ToCharacterCode", "[", "text", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"m95", " ", "=", " ", 
      RowBox[{"mA", " ", "-", " ", "32"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"m10", " ", "=", " ", 
      RowBox[{"FromDigits", "[", 
       RowBox[{"m95", ",", " ", "95"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mPQ", " ", "=", " ", 
      RowBox[{"IntegerDigits", "[", 
       RowBox[{"m10", ",", " ", "PQ"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mPQX", " ", "=", " ", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{"x", ",", " ", 
         RowBox[{"PowerMod", "[", 
          RowBox[{"x", ",", "e", ",", "PQ"}], "]"}]}], "]"}], "/@", " ", 
       "mPQ"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mX95", " ", "=", " ", 
      RowBox[{"IntegerDigits", "[", 
       RowBox[{"mPQX", ",", " ", "95"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"FromCharacterCode", "[", 
      RowBox[{"mX95", "+", "32"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Desxifrar", "[", 
   RowBox[{"text0_", ",", "PQ0_", ",", "d0_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"text", "=", "text0"}], ",", 
      RowBox[{"PQ", "=", "PQ0"}], ",", 
      RowBox[{"d", "=", "d0"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mXA", " ", "=", " ", 
      RowBox[{"ToCharacterCode", "[", "text", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mX95", " ", "=", " ", 
      RowBox[{"mXA", " ", "-", " ", "32"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mXPQ", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"FromDigits", "[", 
         RowBox[{
          RowBox[{"mX95", "[", 
           RowBox[{"[", "k", "]"}], "]"}], ",", "95"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"Length", "[", "mX95", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mXPQY", " ", "=", " ", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{"x", ",", " ", 
         RowBox[{"PowerMod", "[", 
          RowBox[{"x", ",", "d", ",", "PQ"}], "]"}]}], "]"}], "/@", " ", 
       "mXPQ"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mXY10", " ", "=", " ", 
      RowBox[{"FromDigits", "[", 
       RowBox[{"mXPQY", ",", " ", "PQ"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mXYA", " ", "=", " ", 
      RowBox[{
       RowBox[{"IntegerDigits", "[", 
        RowBox[{"mXY10", ",", " ", "95"}], "]"}], "+", "32"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"FromCharacterCode", "[", "mXYA", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PQ", " ", "=", " ", 
  "108479011759769393727176308457457051185868202028229648190667018102389154815\
514421272511788818630907941383004277918921724359698326811100798212287777156373\
854025160462416970207713010402684330377900249272920821196418994434689542195444\
008546643909734553918562196237000260811736016995830450094506601223180883688118\
367193617732939585810720318219660211710733808215174048484794731011578459721161\
876052257146687991978315725043744813520691467819521825409725421924282740640715\
767718923851036438509804069110541415248000720606907056103122751808376882405235\
966768597369796819161915929329975604623470108492326664937"}]], "Input",
 CellChangeTimes->{{3.7982734285986233`*^9, 3.798273438108631*^9}}],

Cell[BoxData[\
"10847901175976939372717630845745705118586820202822964819066701810238915481551\
442127251178881863090794138300427791892172435969832681110079821228777715637385\
402516046241697020771301040268433037790024927292082119641899443468954219544400\
854664390973455391856219623700026081173601699583045009450660122318088368811836\
719361773293958581072031821966021171073380821517404848479473101157845972116187\
605225714668799197831572504374481352069146781952182540972542192428274064071576\
771892385103643850980406911054141524800072060690705610312275180837688240523596\
6768597369796819161915929329975604623470108492326664937"], "Output",
 CellChangeTimes->{3.79827343913762*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d", " ", "=", 
  "157238868457806941988695140484247563626677294530901253183276826596219811125\
010184304778329475347408332570585949630101609862360842812770195861517576193138\
750066681693200788636673900593603582163489848172499708707353439680231519002337\
665622296385327890344291252750871107554676944848237081446017586755512125148558\
007248201721435877186931652101145789498025911037922219736448856713315569806186\
965766941380791117252761860834584243964311329944085157334460030949709207092200\
707053564723625921634242398764037166736336995429241835327231023611329450731025\
9646342051469755043457605243108626031004402568619941751"}]], "Input",
 CellChangeTimes->{{3.7982734401016245`*^9, 3.79827345026462*^9}}],

Cell[BoxData[\
"15723886845780694198869514048424756362667729453090125318327682659621981112501\
018430477832947534740833257058594963010160986236084281277019586151757619313875\
006668169320078863667390059360358216348984817249970870735343968023151900233766\
562229638532789034429125275087110755467694484823708144601758675551212514855800\
724820172143587718693165210114578949802591103792221973644885671331556980618696\
576694138079111725276186083458424396431132994408515733446003094970920709220070\
705356472362592163424239876403716673633699542924183532723102361132945073102596\
46342051469755043457605243108626031004402568619941751"], "Output",
 CellChangeTimes->{3.798273450988619*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"PQA", ",", "eA"}], "}"}], "=", 
  RowBox[{"{", 
   RowBox[{
   "59197531294136016660440875423715670977851135617958323967197827211065920452\
140163928337975213209117942245809116996911219583996098073417962012997114172536\
920173316737075279528587714896987856253211559106622588874773504833346357864752\
244981929712473676691073431670770911501064794097767306421804372668719956505115\
796479967607950331790403655980981873572892480762193767197961449789440855841180\
462617689297001152527912595815026763111969232190520639825516486656498731902992\
069240630322007477232251437495163364616333293164422742320623300345623239348056\
959249258286580235894046005439763414037012283151730457467", ",", 
    "7100437689862443658426591347474520355462857551614315664230471567554282927\
772820448174923935964519735611436640108897262726393465913542956679208213808538\
760396194552999471699229469347817295252648223508818732926605012495683033264300\
646099880070010588168304250664080704958515632215031393367390353579040045911708\
844408500523237094930900090606631060421791335043154630120733870760580705606327\
779078918228327560533363936212503817045511915664621338091982220300377867487788\
093966133585143591655206171164052045823712524884256829336911291434054838317270\
77250551857585717766108827525110906948714906866314516777"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.798274010468918*^9, 3.7982740385961666`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "591975312941360166604408754237156709778511356179583239671978272110659204521\
401639283379752132091179422458091169969112195839960980734179620129971141725369\
201733167370752795285877148969878562532115591066225888747735048333463578647522\
449819297124736766910734316707709115010647940977673064218043726687199565051157\
964799676079503317904036559809818735728924807621937671979614497894408558411804\
626176892970011525279125958150267631119692321905206398255164866564987319029920\
692406303220074772322514374951633646163332931644227423206233003456232393480569\
59249258286580235894046005439763414037012283151730457467", ",", 
   "71004376898624436584265913474745203554628575516143156642304715675542829277\
728204481749239359645197356114366401088972627263934659135429566792082138085387\
603961945529994716992294693478172952526482235088187329266050124956830332643006\
460998800700105881683042506640807049585156322150313933673903535790400459117088\
444085005232370949309000906066310604217913350431546301207338707605807056063277\
790789182283275605333639362125038170455119156646213380919822203003778674877880\
939661335851435916552061711640520458237125248842568293369112914340548383172707\
7250551857585717766108827525110906948714906866314516777"}], "}"}]], "Output",
 CellChangeTimes->{3.798274039428158*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["PQA"], "Input",
 CellChangeTimes->{{3.7982740417711587`*^9, 3.7982740421761694`*^9}}],

Cell[BoxData[\
"59197531294136016660440875423715670977851135617958323967197827211065920452140\
163928337975213209117942245809116996911219583996098073417962012997114172536920\
173316737075279528587714896987856253211559106622588874773504833346357864752244\
981929712473676691073431670770911501064794097767306421804372668719956505115796\
479967607950331790403655980981873572892480762193767197961449789440855841180462\
617689297001152527912595815026763111969232190520639825516486656498731902992069\
240630322007477232251437495163364616333293164422742320623300345623239348056959\
249258286580235894046005439763414037012283151730457467"], "Output",
 CellChangeTimes->{3.798274043400158*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Xifrar", "[", 
  RowBox[{"\"\<Hola bon dia\>\"", ",", "PQA", ",", "eA"}], "]"}]], "Input",
 CellChangeTimes->{{3.798274049053194*^9, 3.7982740642857404`*^9}}],

Cell[BoxData[
 RowBox[{"{", \
"\<\"$FNr_mzv%khuyM'2Q^bdL|wMC#!TtI\\\\SK+|19W=/5W|>u'*z)Z%r>!D}B \
3uT=XT;#s3AID7>6py'MZo^A'LY~bc`cQ0!O&#R$%u0!`G?-fkTVbIKakQPV,B=7`O\\\\c}Ic~\
R2DERD4oB]Q?&`KU>`=n^rGr]\\\\kM1dsMAs<{(6+f7eW\\\\Tk/8w;HdsRfN#Keps\\\\,g-DhA=\
7S6Cw9L7-z[lt}ny&?F)@e]nk8p?HS[AJ$Sa,*RR~;4?,CkUEG8C.'YKjuA[z$@JLG?2xpQ]\
qaO0Z9mCd2%+*fG_~LV.&Q4#0FOW7+nn\"\>", "}"}]], "Output",
 CellChangeTimes->{3.7982740654957075`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"PQ", ",", "e"}], "}"}]], "Input",
 CellChangeTimes->{{3.798274286273821*^9, 3.798274289276821*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "108479011759769393727176308457457051185868202028229648190667018102389154815\
514421272511788818630907941383004277918921724359698326811100798212287777156373\
854025160462416970207713010402684330377900249272920821196418994434689542195444\
008546643909734553918562196237000260811736016995830450094506601223180883688118\
367193617732939585810720318219660211710733808215174048484794731011578459721161\
876052257146687991978315725043744813520691467819521825409725421924282740640715\
767718923851036438509804069110541415248000720606907056103122751808376882405235\
966768597369796819161915929329975604623470108492326664937", ",", "65537"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.798274290030823*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["P"], "Input",
 CellChangeTimes->{3.7982774586043544`*^9}],

Cell[BoxData[\
"20395687835640197740576586692903457728019399331434826309477264645328306272270\
127763293661606314408817331237288267712387953870940015830656733832827915449969\
836607190676644003707421711780569087279284814911202228633214487618337632651208\
3574821647933992961249917319836219304274280243803104015000563790123"], \
"Output",
 CellChangeTimes->{3.7982774589713755`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["Q"], "Input",
 CellChangeTimes->{3.7982774697203484`*^9}],

Cell[BoxData[\
"53187228905420418418508473437513339940830361398213085664529946493095217860604\
584887712914782038799642817556422820478584614120753246293633983413941240197533\
870579464659548732436519479282218947309227399358058796457165967808448415260388\
1094176995594813302284232006001752128168901293560051833646881436219"], \
"Output",
 CellChangeTimes->{3.798277470066345*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"P", "*", "Q"}], "\[Equal]", "PQ"}]], "Input",
 CellChangeTimes->{{3.7982774734723487`*^9, 3.7982774763653526`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.798277476884348*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"GCD", "[", 
      RowBox[{
       RowBox[{"e", "-", "1"}], ",", 
       RowBox[{"P", "-", "1"}]}], "]"}], "+", "1"}], ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"GCD", "[", 
      RowBox[{
       RowBox[{"e", "-", "1"}], ",", 
       RowBox[{"Q", "-", "1"}]}], "]"}], "+", "1"}], ")"}]}], "+", 
  "1"}]], "Input",
 CellChangeTimes->{{3.7982774842533474`*^9, 3.798277549093359*^9}}],

Cell[BoxData["10"], "Output",
 CellChangeTimes->{{3.7982775426363487`*^9, 3.798277549469344*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"k", "=", "0"}], ",", 
     RowBox[{"i", "=", "0"}], ",", "x"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"While", "[", 
    RowBox[{
     RowBox[{"i", "<", "2"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"k", "*", "PQ"}], "+", "1"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"1", "/", 
          RowBox[{"2", "^", "16"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"IntegerQ", "[", "x", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"i", "++"}], ";", 
          RowBox[{"Print", "[", 
           RowBox[{"FromCharacterCode", "[", 
            RowBox[{
             RowBox[{"IntegerDigits", "[", 
              RowBox[{"x", ",", "95"}], "]"}], "+", "32"}], "]"}], "]"}]}], 
         "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"k", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.798277659384862*^9, 3.798277664195803*^9}, {
  3.7982777868915405`*^9, 3.798277865741584*^9}, {3.798277928166667*^9, 
  3.7982779992766676`*^9}, {3.7982780370756655`*^9, 3.798278054276668*^9}, {
  3.798278093958675*^9, 3.7982781503296657`*^9}, {3.798278396202509*^9, 
  3.798278503244211*^9}, {3.7982799266053576`*^9, 3.7982799309853573`*^9}, {
  3.7982801510464067`*^9, 3.7982801716893587`*^9}, {3.7982802389633784`*^9, 
  3.7982802395883274`*^9}, {3.798280298143334*^9, 3.7982802997473364`*^9}, {
  3.7982805171428237`*^9, 3.7982805177288294`*^9}, {3.798280612315827*^9, 
  3.7982806204478273`*^9}}],

Cell[BoxData["\<\"!\"\>"], "Print",
 CellChangeTimes->{
  3.7982803006753273`*^9, 3.79828052034182*^9, {3.798280615556818*^9, 
   3.798280621170817*^9}}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.7982809491737227`*^9}]
}, Open  ]]
},
WindowSize->{1366, 685},
WindowMargins->{{Automatic, -1374}, {-9, Automatic}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 3158, 79, 354, "Input"],
Cell[CellGroupData[{
Cell[3741, 103, 744, 10, 107, "Input"],
Cell[4488, 115, 684, 9, 88, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5209, 129, 735, 10, 107, "Input"],
Cell[5947, 141, 683, 9, 88, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6667, 155, 1445, 22, 183, "Input"],
Cell[8115, 179, 1344, 19, 164, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9496, 203, 99, 1, 30, "Input"],
Cell[9598, 206, 684, 9, 88, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10319, 220, 182, 3, 30, "Input"],
Cell[10504, 225, 429, 7, 69, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10970, 237, 139, 3, 30, "Input"],
Cell[11112, 242, 738, 12, 88, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11887, 259, 71, 1, 30, "Input"],
Cell[11961, 262, 381, 6, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12379, 273, 71, 1, 30, "Input"],
Cell[12453, 276, 379, 6, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12869, 287, 150, 3, 30, "Input"],
Cell[13022, 292, 73, 1, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13132, 298, 468, 16, 30, "Input"],
Cell[13603, 316, 97, 1, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13737, 322, 1755, 41, 145, "Input"],
Cell[15495, 365, 153, 3, 22, "Print"],
Cell[15651, 370, 79, 1, 63, "Output"]
}, Open  ]]
}
]
*)

